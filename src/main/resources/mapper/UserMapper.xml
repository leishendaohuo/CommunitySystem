<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="maven.CommunitySystem.dao.IUserDao">
    <resultMap id="BaseResultMap" type="maven.CommunitySystem.entity.User">
        <result column="id" property="id" jdbcType="INTEGER" />
        <result column="username" property="username" jdbcType="VARCHAR" />
        <result column="password" property="password" jdbcType="VARCHAR" />
        <result column="email" property="email" jdbcType="VARCHAR" />
        <result column="create_time" property="create_time" jdbcType="DATE" />
        <result column="usertype" property="usertype" jdbcType="INTEGER" />
        <result column="url" property="headimg" jdbcType="VARCHAR" />
        <result column="BelongCommunity" property="belongcommunity" jdbcType="VARCHAR" />
 
    </resultMap>
 
 
 	<!--用户信息更新 -->
    <update id="changes" parameterType="java.util.Map">
        UPDATE
        user
        SET
        username=#{newusername,jdbcType=VARCHAR},
        email=#{newemail,jdbcType=VARCHAR},
        password=#{newpassword,jdbcType=VARCHAR}
        WHERE
        username=#{oldusername,jdbcType=VARCHAR}
        and
        email=#{oldemail,jdbcType=VARCHAR}
        and
        password=#{oldpassword,jdbcType=VARCHAR}
    </update>
 
    <!--用户登录 -->
    <select id="Login" parameterType="java.util.Map" resultType="maven.CommunitySystem.entity.User">
        SELECT
        *
        FROM
        user
        WHERE
        email=#{email,jdbcType=VARCHAR}
        AND
        password=#{password,jdbcType=VARCHAR}
    </select>
    
    <!--添加用户 -->
    <insert id="AddUser" parameterType="java.util.Map">  
        INSERT
        IGNORE 
        INTO 
        user
        (username,email,password,create_time,usertype,url) 
        VALUES (#{username,jdbcType=VARCHAR}, #{email,jdbcType=VARCHAR}, #{password,jdbcType=VARCHAR}, null, 0, null)  
    </insert>
    
    <!--删除用户 -->
    <delete id="DeleteUser" parameterType="java.util.Map">
        DELETE
        FROM
        user
        WHERE
        username=#{username,jdbcType=VARCHAR}
        AND
        password=#{password,jdbcType=VARCHAR}
    </delete>
    
    <!--用户查询 -->
    <select id="SelectUser" parameterType="java.lang.String" resultType="maven.CommunitySystem.entity.User">
        SELECT
        *
        FROM
        user
        WHERE
        username=#{username,jdbcType=VARCHAR}
    </select>
    
    <select id="SelectUserByEmail" parameterType="java.lang.String" resultType="maven.CommunitySystem.entity.User">
        SELECT
        *
        FROM
        user
        WHERE
        email=#{email,jdbcType=VARCHAR}
    </select>
    
    <!--更新信息 -->
    <update id="UpdateUser" parameterType="java.util.Map">
        UPDATE
        user
        SET
        username=#{newname,jdbcType=VARCHAR}
        WHERE
        username=#{oldname,jdbcType=VARCHAR}
    </update>
 
</mapper> 